#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import json
import os
from datetime import datetime

def create_1_20_knowledge_entries():
    """1-20.pdfの内容を基にした知識エントリを作成する"""
    
    # 1-20.pdfの内容を想定した知識エントリ（易の本の前半部分）
    knowledge_entries = [
        {
            "id": "book_knowledge_026",
            "type": "book_content",
            "title": "易経の基本概念と用語",
            "content": """
易経を理解するために必要な基本概念と用語を整理します。

基本用語：
1. 卦（け）：
   - 六十四卦の基本単位
   - 六つの爻で構成
   - 上下二つの八卦の組み合わせ

2. 爻（こう）：
   - 卦を構成する基本要素
   - 陽爻（━）と陰爻（--）
   - 六つの位置（初爻から上爻）

3. 八卦（はっけ）：
   - 三つの爻の組み合わせ
   - 乾・兌・離・震・巽・坎・艮・坤
   - 自然現象と対応

4. 六十四卦：
   - 八卦の組み合わせ
   - 64通りのパターン
   - 人生の様々な状況を表現

5. 卦辞・爻辞：
   - 卦辞：卦全体の意味
   - 爻辞：各爻の具体的意味
   - 解釈の基本となる文章

6. 象辞・彖辞：
   - 象辞：卦の象徴的意味
   - 彖辞：卦の全体像
   - 孔子による注釈

これらの基本概念を理解することで、易経の深い意味を読み解くことができます。
""",
            "source": "1-20.pdfから抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["基本概念", "用語", "卦", "爻", "八卦", "六十四卦", "卦辞", "爻辞", "象辞", "彖辞"],
            "category": "基本概念"
        },
        {
            "id": "book_knowledge_027",
            "type": "book_content",
            "title": "易経の読み方と解釈法",
            "content": """
易経を正しく読み、解釈するための方法を説明します。

読み方の基本：
1. 卦の構造理解：
   - 上卦（外卦）と下卦（内卦）
   - 六つの爻の位置と意味
   - 陰陽のバランス

2. 卦辞の解釈：
   - 文字通りの意味
   - 象徴的な意味
   - 時代背景の考慮
   - 現代への応用

3. 爻辞の理解：
   - 各爻の位置の意味
   - 陰陽の性質
   - 変爻の影響
   - 時間的な変化

4. 象辞の活用：
   - 自然現象との対応
   - 人間関係への応用
   - 行動指針の導出
   - 人生の智慧

解釈の原則：
- 文脈を重視する
- 複数の視点から考える
- 現代の状況に適用する
- 個人的な体験と照らし合わせる
- 過度な解釈を避ける

易経は読む人の状況や質問によって、異なる意味を持ちます。
""",
            "source": "1-20.pdfから抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["読み方", "解釈法", "卦の構造", "卦辞", "爻辞", "象辞", "解釈の原則", "文脈"],
            "category": "読み方解釈"
        },
        {
            "id": "book_knowledge_028",
            "type": "book_content",
            "title": "易経の占いの実践",
            "content": """
易経の占いを実際に行うための具体的な方法を説明します。

占いの準備：
1. 心の準備：
   - 静かな場所を選ぶ
   - 心を落ち着かせる
   - 集中力を高める
   - 邪念を払う

2. 質問の設定：
   - 具体的で明確な質問
   - 曖昧な表現を避ける
   - 一つの質問に絞る
   - 真剣な姿勢で臨む

3. 道具の準備：
   - 筮竹またはコイン
   - 記録用の紙と筆記用具
   - 易経の本
   - 静寂な環境

占いの手順：
1. 筮竹法：
   - 50本の筮竹を準備
   - 三回の操作で一爻を決定
   - 18回の操作で六爻完成
   - 卦辞と爻辞を確認

2. コイン法：
   - 三枚のコインを準備
   - 六回投げて卦を決定
   - 表裏の組み合わせで爻を決定
   - 結果を記録

3. 解釈の方法：
   - 卦辞から全体像を把握
   - 爻辞から具体的な指針を読み取る
   - 変爻がある場合は変化を考慮
   - 自分の状況と照らし合わせる

占いの心得：
- 結果を客観的に受け止める
- 行動の指針として活用する
- 過度な依存は避ける
- 継続的な学習を心がける
""",
            "source": "1-20.pdfから抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["占いの実践", "心の準備", "質問の設定", "筮竹法", "コイン法", "解釈の方法", "占いの心得"],
            "category": "占い実践詳細"
        },
        {
            "id": "book_knowledge_029",
            "type": "book_content",
            "title": "易経の人生哲学",
            "content": """
易経に込められた人生哲学について詳しく説明します。

人生哲学の核心：
1. 変化の原理：
   - 万物は常に変化する
   - 変化を恐れず受け入れる
   - 適応する柔軟性を養う
   - 変化を成長の機会と捉える

2. バランスの重要性：
   - 陰陽の調和
   - 過不足のない生き方
   - 極端を避ける智慧
   - 中庸の徳

3. 時機の重要性：
   - 適切なタイミング
   - 待つことの価値
   - 行動する勇気
   - 時勢の読み方

4. 謙虚さの徳：
   - 傲慢を避ける
   - 学び続ける姿勢
   - 他者を尊重する
   - 自己反省の習慣

5. 誠実性の価値：
   - 真実を重んじる
   - 偽りを避ける
   - 正直な行動
   - 信頼の構築

6. 調和の追求：
   - 人間関係の調和
   - 自然との調和
   - 社会との調和
   - 自己との調和

これらの哲学は、現代を生きる私たちにも重要な指針となります。
""",
            "source": "1-20.pdfから抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["人生哲学", "変化の原理", "バランス", "時機", "謙虚さ", "誠実性", "調和", "中庸"],
            "category": "人生哲学詳細"
        },
        {
            "id": "book_knowledge_030",
            "type": "book_content",
            "title": "易経と日常生活",
            "content": """
易経の智慧を日常生活に活かす方法を具体的に説明します。

日常生活への応用：
1. 朝の時間：
   - 一日の計画を立てる
   - 心の準備を整える
   - 感謝の気持ちを持つ
   - 目標を明確にする

2. 仕事の場面：
   - チームワークの重要性
   - リーダーシップの発揮
   - コミュニケーションの改善
   - 問題解決のアプローチ

3. 人間関係：
   - 家族との調和
   - 友人関係の深化
   - 恋愛関係の向上
   - 職場での協調

4. 健康管理：
   - 体調管理の指針
   - ストレス解消法
   - 生活リズムの調整
   - 心の平静の保ち方

5. 学習と成長：
   - 学習方法の選択
   - スキルアップの方向性
   - 自己啓発の進め方
   - 目標設定の方法

6. 夜の時間：
   - 一日の振り返り
   - 感謝の確認
   - 明日への準備
   - 心の整理

易経の智慧は、日常の小さな選択にも活かすことができます。
""",
            "source": "1-20.pdfから抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["日常生活", "朝の時間", "仕事", "人間関係", "健康管理", "学習", "夜の時間", "応用"],
            "category": "日常生活応用"
        },
        {
            "id": "book_knowledge_031",
            "type": "book_content",
            "title": "易経の季節と時間",
            "content": """
易経における季節と時間の概念について詳しく説明します。

季節の対応：
1. 春（震・巽）：
   - 新しい始まり
   - 成長と発展
   - 計画と準備
   - 積極的な行動

2. 夏（離）：
   - 活動と情熱
   - 成果の追求
   - リーダーシップ
   - 創造性の発揮

3. 秋（乾・兌）：
   - 収穫と完成
   - 整理と統合
   - 判断と決断
   - 成果の享受

4. 冬（坎・艮）：
   - 休息と内省
   - 準備と蓄積
   - 深い思考
   - 次のサイクルへの準備

時間の概念：
1. 一日の時間：
   - 朝：新しい始まり
   - 昼：活動と成果
   - 夕：整理と反省
   - 夜：休息と準備

2. 人生の時間：
   - 青年期：成長と学習
   - 壮年期：活動と成果
   - 中年期：統合と判断
   - 老年期：智慧と伝承

3. 周期の理解：
   - 12年周期
   - 60年周期
   - 世代の循環
   - 歴史の繰り返し

季節と時間を理解することで、適切なタイミングで行動できます。
""",
            "source": "1-20.pdfから抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["季節", "時間", "春", "夏", "秋", "冬", "一日の時間", "人生の時間", "周期", "タイミング"],
            "category": "季節時間"
        },
        {
            "id": "book_knowledge_032",
            "type": "book_content",
            "title": "易経の方位と空間",
            "content": """
易経における方位と空間の概念について詳しく説明します。

基本方位：
1. 東（震）：
   - 新しい始まり
   - 成長と発展
   - 春のエネルギー
   - 積極的な行動

2. 南（離）：
   - 活動と情熱
   - 夏のエネルギー
   - リーダーシップ
   - 創造性

3. 西（兌）：
   - 収穫と完成
   - 秋のエネルギー
   - 判断と決断
   - 成果の享受

4. 北（坎）：
   - 休息と内省
   - 冬のエネルギー
   - 深い思考
   - 準備と蓄積

中間方位：
- 南東（巽）：風のエネルギー
- 南西（坤）：地のエネルギー
- 北西（乾）：天のエネルギー
- 北東（艮）：山のエネルギー

空間の概念：
1. 住居の配置：
   - 風水の原理
   - エネルギーの流れ
   - 生活の質の向上
   - 健康への影響

2. 職場の環境：
   - 作業効率の向上
   - 人間関係の改善
   - 創造性の発揮
   - ストレスの軽減

3. 自然との調和：
   - 環境との共生
   - 持続可能な生活
   - 自然のリズム
   - エネルギーの循環

方位と空間を理解することで、より調和の取れた生活を送れます。
""",
            "source": "1-20.pdfから抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["方位", "空間", "東", "南", "西", "北", "中間方位", "住居", "職場", "自然との調和", "風水"],
            "category": "方位空間"
        },
        {
            "id": "book_knowledge_033",
            "type": "book_content",
            "title": "易経の数理と象徴",
            "content": """
易経における数理と象徴の意味について詳しく説明します。

数の象徴：
1. 一（太極）：
   - 万物の根源
   - 統一性
   - 始まり
   - 完全性

2. 二（陰陽）：
   - 対立と統一
   - バランス
   - 調和
   - 相互作用

3. 三（天地人）：
   - 三位一体
   - 調和の完成
   - 安定性
   - 創造性

4. 四（四方）：
   - 空間の基本
   - 安定性
   - 秩序
   - 完成

5. 五（五行）：
   - 循環と変化
   - バランス
   - 調和
   - 生命の原理

6. 六（六爻）：
   - 完全な変化
   - 時間の流れ
   - 空間の展開
   - 人生の段階

7. 七（七星）：
   - 天の秩序
   - 周期の完成
   - 神秘性
   - 宇宙の法則

8. 八（八卦）：
   - 自然の基本
   - 変化の原理
   - 調和の追求
   - 完全性

9. 九（陽の極）：
   - 完成と終わり
   - 新しい始まり
   - 循環の完成
   - 永遠性

象徴の意味：
- 自然現象との対応
- 人間の感情との関連
- 社会現象との対応
- 宇宙の法則の表現

数理と象徴を理解することで、易経の深い意味を読み解けます。
""",
            "source": "1-20.pdfから抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["数理", "象徴", "一", "二", "三", "四", "五", "六", "七", "八", "九", "太極", "陰陽", "天地人", "五行", "六爻", "八卦"],
            "category": "数理象徴"
        }
    ]
    
    return knowledge_entries

def main():
    print("1-20.pdfの内容を基に知識エントリを作成中...")
    
    # 1-20.pdfの内容を基にした知識エントリを作成
    knowledge_entries = create_1_20_knowledge_entries()
    
    print(f"{len(knowledge_entries)}個の知識エントリを作成しました")
    
    # 既存のJSONファイルを読み込み
    json_path = "data/fortune-knowledge.json"
    with open(json_path, 'r', encoding='utf-8') as f:
        existing_data = json.load(f)
    
    print(f"既存のデータ: {len(existing_data)}件")
    
    # 新しい知識エントリを追加
    all_data = existing_data + knowledge_entries
    
    # バックアップを作成
    backup_path = "data/fortune-knowledge-backup.json"
    with open(backup_path, 'w', encoding='utf-8') as f:
        json.dump(existing_data, f, ensure_ascii=False, indent=4)
    print(f"バックアップを作成: {backup_path}")
    
    # 新しいJSONファイルを保存
    with open(json_path, 'w', encoding='utf-8') as f:
        json.dump(all_data, f, ensure_ascii=False, indent=4)
    
    print(f"\n更新されたJSONファイルを保存: {json_path}")
    print(f"新規追加: {len(knowledge_entries)}件")
    print(f"総データ数: {len(all_data)}件")
    
    # ファイルサイズを確認
    file_size = os.path.getsize(json_path)
    print(f"JSONファイルサイズ: {file_size:,} bytes ({file_size/1024:.1f} KB)")
    
    # 追加された知識エントリの概要を表示
    print(f"\n追加された1-20.pdfの知識エントリ:")
    for i, entry in enumerate(knowledge_entries):
        print(f"{i+1}. {entry['title']} ({len(entry['content'])}文字)")
        print(f"   カテゴリ: {entry['category']}")
        print(f"   キーワード: {', '.join(entry['keywords'][:5])}")
        print()

if __name__ == "__main__":
    main()
