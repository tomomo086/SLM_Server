#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import json
import os
from datetime import datetime

def create_comprehensive_knowledge():
    """易の本の包括的な内容を知識として追加する"""
    
    comprehensive_entries = [
        {
            "id": "book_knowledge_008",
            "type": "book_content",
            "title": "易経の歴史と成立",
            "content": """
易経の歴史は古く、その起源は紀元前3000年頃の伏羲（ふっき）に遡るとされています。

歴史的発展：
1. 伏羲時代：八卦の創始
   - 河図洛書の伝説
   - 自然観察から八卦を発見
   - 陰陽思想の萌芽

2. 文王時代（紀元前11世紀）：
   - 六十四卦の完成
   - 卦辞の作成
   - 周王朝の建国と易経

3. 周公時代：
   - 爻辞の追加
   - 易経の体系化
   - 占いから哲学への発展

4. 孔子時代（紀元前6-5世紀）：
   - 十翼（じゅうよく）の作成
   - 象辞、彖辞の追加
   - 易経の哲学的完成

5. 漢代以降：
   - 易経の注釈書の充実
   - 象数易と義理易の分化
   - 各時代の学者による解釈の発展

易経は単なる占いの書から、中国思想の根幹をなす哲学書へと発展しました。
""",
            "source": "易の本から抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["易経", "歴史", "伏羲", "文王", "周公", "孔子", "十翼", "河図洛書"],
            "category": "歴史"
        },
        {
            "id": "book_knowledge_009",
            "type": "book_content",
            "title": "陰陽思想の深層理解",
            "content": """
陰陽思想は易経の根本原理であり、宇宙のすべての現象を説明する哲学です。

陰陽の本質：
- 陰（☷）：暗、冷、静、内、柔、受動、女性性
- 陽（☰）：明、熱、動、外、剛、能動、男性性

陰陽の関係性：
1. 対立統一：相反するが相互依存
2. 相互転化：極まれば反対に転じる
3. 相互包含：陰中に陽、陽中に陰
4. 相互制約：バランスを保つ

陰陽の応用：
- 医学：気血の調和
- 建築：風水の原理
- 武術：剛柔の調和
- 料理：五味の調和
- 音楽：高低の調和

陰陽思想は単なる二元論ではなく、動的な調和の哲学です。
""",
            "source": "易の本から抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["陰陽", "対立統一", "相互転化", "相互包含", "相互制約", "調和", "哲学"],
            "category": "陰陽思想"
        },
        {
            "id": "book_knowledge_010",
            "type": "book_content",
            "title": "五行思想の詳細",
            "content": """
五行思想は易経と密接に関連する中国の自然哲学の核心です。

五行の詳細：
1. 木（もく）：
   - 性質：曲直、成長、創造
   - 方位：東、季節：春
   - 色：青、味：酸
   - 臓器：肝、感情：怒
   - 卦：震☳、巽☴

2. 火（か）：
   - 性質：炎上、活動、情熱
   - 方位：南、季節：夏
   - 色：赤、味：苦
   - 臓器：心、感情：喜
   - 卦：離☲

3. 土（ど）：
   - 性質：稼穡、安定、調和
   - 方位：中央、季節：土用
   - 色：黄、味：甘
   - 臓器：脾、感情：思
   - 卦：坤☷、艮☶

4. 金（ごん）：
   - 性質：従革、収穫、決断
   - 方位：西、季節：秋
   - 色：白、味：辛
   - 臓器：肺、感情：悲
   - 卦：乾☰、兌☱

5. 水（すい）：
   - 性質：潤下、保存、知恵
   - 方位：北、季節：冬
   - 色：黒、味：鹹
   - 臓器：腎、感情：恐
   - 卦：坎☵

相生相克の詳細：
- 相生：木生火、火生土、土生金、金生水、水生木
- 相克：木克土、土克水、水克火、火克金、金克木
""",
            "source": "易の本から抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["五行", "木", "火", "土", "金", "水", "相生", "相克", "方位", "季節", "色", "味", "臓器"],
            "category": "五行詳細"
        },
        {
            "id": "book_knowledge_011",
            "type": "book_content",
            "title": "八卦の詳細解説",
            "content": """
八卦は易経の基本単位であり、それぞれに深い意味があります。

基本八卦の詳細：

1. 乾（けん）☰：
   - 象：天、父、君主、馬、金、玉
   - 徳：健、剛、強、進
   - 方位：西北、季節：晩秋
   - 数：一、色：白

2. 兌（だ）☱：
   - 象：沢、少女、羊、口、説
   - 徳：悦、和、柔、順
   - 方位：西、季節：秋
   - 数：二、色：白

3. 離（り）☲：
   - 象：火、中女、雉、目、明
   - 徳：麗、明、智、文
   - 方位：南、季節：夏
   - 数：三、色：赤

4. 震（しん）☳：
   - 象：雷、長男、龍、足、動
   - 徳：動、起、驚、威
   - 方位：東、季節：春
   - 数：四、色：青

5. 巽（そん）☴：
   - 象：風、長女、鶏、股、入
   - 徳：入、順、柔、伏
   - 方位：南東、季節：春
   - 数：五、色：青

6. 坎（かん）☵：
   - 象：水、中男、豚、耳、険
   - 徳：険、陷、智、信
   - 方位：北、季節：冬
   - 数：六、色：黒

7. 艮（ごん）☶：
   - 象：山、少男、狗、手、止
   - 徳：止、静、堅、固
   - 方位：北東、季節：冬
   - 数：七、色：黒

8. 坤（こん）☷：
   - 象：地、母、牛、腹、順
   - 徳：順、柔、厚、載
   - 方位：西南、季節：晩夏
   - 数：八、色：黄
""",
            "source": "易の本から抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["八卦", "乾", "兌", "離", "震", "巽", "坎", "艮", "坤", "象", "徳", "方位", "季節"],
            "category": "八卦詳細"
        },
        {
            "id": "book_knowledge_012",
            "type": "book_content",
            "title": "易経の占い方法詳細",
            "content": """
易経の占いには複数の方法があり、それぞれに特徴があります。

1. 筮竹法（最も伝統的）：
   道具：50本の筮竹（実際は49本使用）
   手順：
   - 筮竹を左手で持つ
   - 右手で筮竹を分ける
   - 三回の操作で一爻を決定
   - 18回の操作で六爻完成
   特徴：最も正確、時間がかかる

2. コイン法（簡易版）：
   道具：三枚のコイン
   手順：
   - 三枚同時に投げる
   - 表裏の組み合わせで爻を決定
   - 六回投げて卦を完成
   特徴：初心者向け、短時間

3. 数理法：
   道具：生年月日、時刻
   手順：
   - 生年月日から上卦を算出
   - 時刻から下卦を算出
   - 組み合わせて卦を決定
   特徴：道具不要、即座に結果

4. 梅花易数：
   道具：数字、時間、物象
   手順：
   - 偶然の数字や現象を利用
   - 数理的な計算で卦を決定
   特徴：直感的、応用範囲広い

占いの心得：
- 心を静めて集中する
- 具体的で明確な質問を用意する
- 結果を客観的に受け止める
- 行動の指針として活用する
- 依存せず、参考程度に留める
""",
            "source": "易の本から抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["筮竹法", "コイン法", "数理法", "梅花易数", "占い方法", "心得", "道具", "手順"],
            "category": "占い方法詳細"
        },
        {
            "id": "book_knowledge_013",
            "type": "book_content",
            "title": "易経の故事と人物",
            "content": """
易経には多くの故事と人物が登場し、それぞれに深い教訓があります。

主要な人物と故事：

1. 伏羲（ふっき）：
   - 八卦の創始者
   - 河図洛書の伝説
   - 自然観察から易を発見

2. 文王（ぶんおう）：
   - 六十四卦の完成者
   - 羑里での幽閉中に易を研究
   - 周王朝の建国者

3. 周公（しゅうこう）：
   - 爻辞の作者
   - 礼制の確立者
   - 易経の体系化

4. 孔子（こうし）：
   - 十翼の作者
   - 易経の哲学的完成
   - 「五十にして易を学ぶ」

5. 姜太公（きょうたいこう）：
   - 文王の軍師
   - 易経の実践者
   - 兵法と易経の結合

6. 諸葛亮（しょかつりょう）：
   - 三国時代の軍師
   - 易経を戦略に活用
   - 八陣図の創始者

7. 邵雍（しょうよう）：
   - 宋代の易学者
   - 梅花易数の創始者
   - 先天易の体系化

8. 朱熹（しゅき）：
   - 宋代の儒学者
   - 易経の注釈者
   - 理気論の確立

これらの人物の故事は、易経の実践的応用を示しています。
""",
            "source": "易の本から抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["伏羲", "文王", "周公", "孔子", "姜太公", "諸葛亮", "邵雍", "朱熹", "故事", "人物", "河図洛書", "羑里", "十翼"],
            "category": "故事人物"
        },
        {
            "id": "book_knowledge_014",
            "type": "book_content",
            "title": "易経の解釈学",
            "content": """
易経の解釈には複数の学派があり、それぞれ異なるアプローチを取ります。

主要な解釈学派：

1. 象数易（しょうすうえき）：
   - 象と数に重点を置く
   - 数学的、図象的な解釈
   - 漢代に発達
   - 代表者：孟喜、京房

2. 義理易（ぎりえき）：
   - 義理に重点を置く
   - 哲学的、倫理的な解釈
   - 魏晋時代に発達
   - 代表者：王弼、韓康伯

3. 図書易（としょえき）：
   - 河図洛書を重視
   - 宋代に発達
   - 代表者：陳摶、邵雍

4. 考証易（こうしょうえき）：
   - 文献学的アプローチ
   - 清代に発達
   - 代表者：胡渭、毛奇齢

解釈の原則：
1. 象辞：卦の象徴的意味
2. 彖辞：卦の全体像
3. 爻辞：各爻の具体的意味
4. 文言：乾坤二卦の詳細解説
5. 序卦：六十四卦の順序の意味
6. 雑卦：卦の対比関係

現代の解釈：
- 心理学的解釈
- 経営学的応用
- 医学的応用
- 環境学的視点
""",
            "source": "易の本から抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["象数易", "義理易", "図書易", "考証易", "解釈学", "象辞", "彖辞", "爻辞", "文言", "序卦", "雑卦"],
            "category": "解釈学"
        },
        {
            "id": "book_knowledge_015",
            "type": "book_content",
            "title": "易経と現代生活",
            "content": """
易経の智慧は現代生活の様々な場面で活用できます。

ビジネスでの応用：
1. 意思決定：
   - タイミングの判断
   - リスクの評価
   - 戦略の選択

2. 人間関係：
   - コミュニケーションの改善
   - チームワークの向上
   - リーダーシップの発揮

3. 経営管理：
   - 組織の変革
   - 危機管理
   - 持続的成長

個人の成長：
1. 自己理解：
   - 性格の分析
   - 強みと弱みの把握
   - 人生の方向性

2. ストレス管理：
   - 心の平静
   - バランスの取れた生活
   - 困難への対処

3. 人間関係：
   - 家族関係の改善
   - 友人関係の深化
   - 恋愛関係の向上

健康管理：
1. 養生法：
   - 季節に応じた生活
   - 陰陽の調和
   - 五行のバランス

2. 精神衛生：
   - 心の平静
   - 感情のコントロール
   - ストレスの解消

注意点：
- 易経は決定を強制するものではない
- 科学的根拠と併用する
- バランスの取れた視点を保つ
- 過度な依存は避ける
""",
            "source": "易の本から抽出",
            "extracted_date": datetime.now().isoformat(),
            "keywords": ["現代生活", "ビジネス", "意思決定", "人間関係", "経営管理", "自己理解", "ストレス管理", "健康管理", "養生法", "精神衛生"],
            "category": "現代応用詳細"
        }
    ]
    
    return comprehensive_entries

def main():
    print("易の本の包括的な内容を知識として追加中...")
    
    # 包括的な知識エントリを作成
    comprehensive_entries = create_comprehensive_knowledge()
    
    print(f"{len(comprehensive_entries)}個の包括的な知識エントリを作成しました")
    
    # 既存のJSONファイルを読み込み
    json_path = "data/fortune-knowledge.json"
    with open(json_path, 'r', encoding='utf-8') as f:
        existing_data = json.load(f)
    
    print(f"既存のデータ: {len(existing_data)}件")
    
    # 新しい知識エントリを追加
    all_data = existing_data + comprehensive_entries
    
    # バックアップを作成
    backup_path = "data/fortune-knowledge-backup.json"
    with open(backup_path, 'w', encoding='utf-8') as f:
        json.dump(existing_data, f, ensure_ascii=False, indent=4)
    print(f"バックアップを作成: {backup_path}")
    
    # 新しいJSONファイルを保存
    with open(json_path, 'w', encoding='utf-8') as f:
        json.dump(all_data, f, ensure_ascii=False, indent=4)
    
    print(f"\n更新されたJSONファイルを保存: {json_path}")
    print(f"新規追加: {len(comprehensive_entries)}件")
    print(f"総データ数: {len(all_data)}件")
    
    # ファイルサイズを確認
    file_size = os.path.getsize(json_path)
    print(f"JSONファイルサイズ: {file_size:,} bytes ({file_size/1024:.1f} KB)")
    
    # 追加された知識エントリの概要を表示
    print(f"\n追加された包括的な知識エントリ:")
    for i, entry in enumerate(comprehensive_entries):
        print(f"{i+1}. {entry['title']} ({len(entry['content'])}文字)")
        print(f"   カテゴリ: {entry['category']}")
        print(f"   キーワード: {', '.join(entry['keywords'][:5])}")
        print()

if __name__ == "__main__":
    main()
